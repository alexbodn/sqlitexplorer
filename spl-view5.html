<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<style>
			body {
				/*margin: 0px;*/
				margin-left: 0;
				margin-right: 0;
			}
			div#sqlDiv, #map {
				width: 98vw;
				height: 59vh;
				margin-top: 1vh;
				margin-right: 1vw;
				margin-left: 1vw;
				border: solid 1px gray;
				
				/*position: fixed;*/
			}
		</style>
		<script>
			window.onerror = function (message, url, line, column, error) {
				alert(message, url, line, column, error);
			}
		</script>
		<title>
			spl-view
		</title>
	</head>
	<body>
		<div id="logger"></div>
		<script type="module" src="./main-sql.js"></script>
		<!--script>

const natural_earth_local = new URL('./test/files/dbs/Natural_Earth_QGIS_layers_and_styles.gpkg', window.location.href).toString();
const rivers_remote = 'https://www.geopackage.org/data/rivers.gpkg';
const rivers_local = new URL('./test/files/dbs/rivers.gpkg', window.location.href).toString();
const db_small = new URL('./test/files/dbs/db_small.sqlite', window.location.href).toString();

// mountpoint/filename has to be unique.
/**/
//let url = natural_earth_local;
//let url = rivers_local;
let url = db_small;
window.userData = [
	{
		mountpoint: 'data',
		filename: 'db.sqlite',
		isdb: true,
		url,
		//noFetch: true,
		method: 'arrayBuffer',
	},
];
/**/

let program;
//program = "./dctour.js";
//program = "./stlouis.js";
//program = "./london_boroughs.js";
//program = "./lights.js";
//program = "./tri.js";


	}
})
.then(() => {
	if (!program) {
		return Promise.resolve();
	}
	document.head.querySelector('title')
		.textContent = program;
	return jsLoad(program);
})
//.then(() => jsLoad("./lib/eruda.js"))
.then(() => jsLoad('./lib/spl-view4.js', true))
;

function onData(db, fetched) {
	
	let map = window.map,
		xplorer = window.xplorer;
	
	xplorer.setDb(db);
	for (let [mount, info] of Object.entries(fetched)) {
		if ('layers' in info) {
			for (let layer of info.layers) {
				map.addLayer(layer);
			}
		}
	}
	
	if (xplorer) {
		xplorer.addSnippets(
			window.extraSnippets || {});
		xplorer.showMap(window.viewOptions);
	}
	else {
		map.show_map(window.viewOptions);
	}
}
		</script-->
		<!--script src="./lib/eruda.js" type="text/javascript"></script-->
	</body>
</html>
